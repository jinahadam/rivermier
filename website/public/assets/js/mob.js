$(document).bind("mobileinit",function(){function h(a,b){var c=/@\w+|#\w+|(?:https?|ftp):\/\/.*?\..*?(?=\W?(\s|$))/gi,d=$(a);var e,f=0;c.lastIndex=0;while(e=c.exec(b)){d.append($("<span/>").text(b.slice(f,e.index)));if(e[0].slice(0,1)=="@"){d.append($("<a/>").attr("href","http://twitter.com/"+encodeURIComponent(e[0].slice(1))).attr("target","_blank").text(e[0]))}else if(e[0].slice(0,1)=="#"){d.append($("<a/>").attr("href","http://twitter.com/search/"+encodeURIComponent(e[0].slice(1))).attr("target","_blank").text(e[0]))}else{d.append($("<a/>").attr("href",e[0]).attr("target","_blank").text(e[0]))}f=c.lastIndex}d.append($("<span/>").text(b.slice(f)))}function g(a){var b=0;if($(a+" > .load-more > .count").length!=0){var b=$(a+" > .load-more > .count").text()}b=parseInt(b)+1;$(a+" > .load-more").remove();$(a).prepend('<div class="load-more">Show <span class="count"></span> New Tweets</div>');$(a+" > .load-more > .count").text(b);$("div.load-more").bind("click",function(){$(a+" > .hide").show();$(this).remove()})}function f(a){$("#trends").replaceWith('<div id="trends"><div class="trends-title">Current Trends</div><p>'+a.trends.join(", ")+"</p></div>")}function e(a){$("#media-content > .tweets").prepend('<div class="hide tweet entity borderless high media_'+a.media_id+'"><div class="crop"><a href="'+a.url+'" target="_blank"><img src="'+a.media_url+'"/></a></div></div>');$("#media > .tweets").prepend('<div class="hide tweet borderless tweet_'+a.tweet_id+'"><div class="sub_tweet"><div class="profile_picture"><img src="'+a.profile_image_url+'"/></div><div class="tweet-details"><strong><a href="https://twitter.com/'+a.screen_name+"/statuses/"+a.tweet_id+'" target="_blank">'+a.name+'</a></strong> <small class="username">@'+a.screen_name+'</small><span class="time" "title='+a.created_at+'"</span><p class="tweet-text tweet_media_'+a.tweet_id+'"></p></div><div class"clear"></div><div class="hide tweet_actions"><div class="row-fluid icons actions tweet_"><span class="reply"><span class="reply-icon twitter-icon"> </span><a href="https://twitter.com/intent/tweet?in_reply_to='+a.tweet_id+'">Reply</a></span><span class="retweet"><span class="retweet-icon twitter-icon"> </span><a href="https://twitter.com/intent/retweet?tweet_id='+a.tweet_id+'">Retweet</a></span><span class="favorite"><span class="favorite-icon twitter-icon"> </span><a href="https://twitter.com/intent/favorite?tweet_id='+a.tweet_id+'">Favorite</a></span><div class"clear"></div></div></div></div>');$(".media_"+a.tweet_id+"  > .tweet-details > .time").timeago();h(".tweet_media_"+a.tweet_id,a.text);g("#media-content > .tweets")}function d(a,b){if(b==true){var c="#popular-tweets-content > .tweets"}else{var c="#trend-makers-content > .tweets"}$(c).prepend('<div class="hide tweet tweet_'+a.tweet_id+'"><div class="sub_tweet"><div class="profile_picture"><img src="'+a.profile_image_url+'"/></div><div class="tweet-details"><strong><a href="https://twitter.com/'+a.screen_name+"/statuses/"+a.tweet_id+'" target="_blank">'+a.name+'</a></strong> <small class="username">@'+a.screen_name+'</small><span class="time" title="'+a.created_at+'"></span><p class="tweet-text '+a.tweet_id+'"></p></div><div class"clear"></div><div class="hide tweet_actions"><div class="row-fluid icons actions tweet_"><span class="reply"><span class="reply-icon twitter-icon"> </span><a href="https://twitter.com/intent/tweet?in_reply_to='+a.tweet_id+'">Reply</a></span><span class="retweet"><span class="retweet-icon twitter-icon"> </span><a href="https://twitter.com/intent/retweet?tweet_id='+a.tweet_id+'">Retweet</a></span><span class="favorite"><span class="favorite-icon twitter-icon"> </span><a href="https://twitter.com/intent/favorite?tweet_id='+a.tweet_id+'">Favorite</a></span><div class"clear"></div></div></div></div>');$(".tweet_"+a.tweet_id+" > .tweet-details > .time").timeago();h("."+a.tweet_id,a.text);g(c)}function c(a){$(".tweet_"+a.tweet_id).next(".entity").remove();$(".tweet_"+a.tweet_id).remove()}function a(a){var b=$(a).find(".sub_tweet").height();$(a).find(".sub_tweet").hide();$(a).find(".tweet_actions").css("height",b);$(a).find(".tweet_actions").css("top",b/2-5);$(a).find(".tweet_actions").show()}$.event.special.swipe.horizontalDistanceThreshold=75;$("#trend-makers").live("pagecreate",function(a){$("#trend-makers-content").find(".tweet-text").each(function(){var a=$(this).find(".original-text").text();h(this,a);$(this).closest(".tweet-details").find(".time").timeago()})});$("#popular-tweets").live("pagecreate",function(a){$("#popular-tweets-content").load("/mobile-retweets",function(){$("#popular-tweets-content").find(".tweet-text").each(function(){var a=$(this).find(".original-text").text();h(this,a);$(this).closest(".tweet-details").find(".time").timeago()})});b.subscribe("retweets",function(a){d(jQuery.parseJSON(a),true)})});$("#photos").live("pagecreate",function(a){$("#photos-content").load("/mobile-photos",function(){$("#photos-content").find(".tweet-text").each(function(){var a=$(this).find(".original-text").text();h(this,a);$(this).closest(".tweet-details").find(".time").timeago()})});b.subscribe("photos",function(a){e(jQuery.parseJSON(a))})});$(".tweet").live("swipe",function(){a($(this))});$(window).bind("resize",function(){$(".fluid").each(function(){this.style.width="100%"})});$(window).bind("scrollstart",function(){$("body").find(".sub_tweet").show();$("body").find(".tweet_actions").hide()});var b=new Juggernaut({host:"stream.rivermier.com",port:80});b.subscribe("tweets",function(a){d(jQuery.parseJSON(a),false)});b.subscribe("trends",function(a){f(jQuery.parseJSON(a))});b.subscribe("deletes",function(a){c(jQuery.parseJSON(a))})})